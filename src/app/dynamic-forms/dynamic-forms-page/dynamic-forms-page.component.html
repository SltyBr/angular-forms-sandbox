<div class="action-buttons">
    <button (click)="formLoadingTrigger.next('user')" type="button">Load User</button>
    <button (click)="formLoadingTrigger.next('company')" type="button">Load Company User</button>
</div>

<div *ngIf="formConfig$ | async as formConfig" class="dynamic-form-container">
    <form [formGroup]="form" (ngSubmit)="onSubmit()">
        <h3>{{ formConfig.description }}</h3>
        <div *ngFor="let control of formConfig.controls | keyvalue" class="form-field">
            <label [for]="control.key">{{ control.value.label }}</label>
            <ng-container [ngSwitch]="control.value.controlType">
                <input *ngSwitchCase="'input'" [formControlName]="control.key" [id]="control.key" [value]="control.value.value" [type]="control.value.type">
                <ng-container *ngSwitchCase="'select'">
                    <select [formControlName]="control.key" [id]="control.key" [value]="control.value.value">
                        <option *ngFor="let o of control.value.options" [value]="o.value">{{o.label}}</option>
                    </select>
                </ng-container>
            </ng-container>
            <ng-container>
                <div *ngIf="form.get(control.key)?.dirty && form.get(control.key)?.hasError('required')" class="input-error">This field is required</div>
                <div *ngIf="form.get(control.key)?.dirty && form.get(control.key)?.hasError('email')" class="input-error">Valid mail</div>
                <div *ngIf="form.get(control.key)?.dirty && form.get(control.key)?.hasError('minlength')" class="input-error">Must contain
                    {{ form.get(control.key)?.getError('minlength').reqiredLength }}
                </div>
                <div *ngIf="form.get(control.key)?.dirty && form.get(control.key)?.hasError('banWords')" class="input-error">
                    This word is not allowed
                </div>
            </ng-container>
        </div>
        <button [disabled]="form.invalid" type="submit">Save</button>
    </form>
</div>